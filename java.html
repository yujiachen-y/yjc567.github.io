<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://raw.githubusercontent.com/yujiachen-y/yjc567.github.io/main/pictures/icon.JPG">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>Java 相关笔记&nbsp;|&nbsp;Jiachen’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="Java 相关笔记">
  
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://raw.githubusercontent.com/yujiachen-y/yjc567.github.io/main/pictures/icon.JPG"></span>&nbsp;
      
      <span>主页</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="tag/%E6%9D%82%E6%96%87.html">
    <div class="Navbar__Btn">
      <span>杂文</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="tag/%E6%8A%80%E6%9C%AF.html">
    <div class="Navbar__Btn">
      <span>技术</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="tag/%E9%98%85%E8%AF%BB.html">
    <div class="Navbar__Btn">
      <span>阅读</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="other.html">
        <div class="Navbar__Btn">
          
          <span>其他</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
          <span>关于</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
    <h1 class="Header__Title">Java 相关笔记</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on 2023年7月23日周日</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/技术.html">技术</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/7c890ece897c4f4f9974cf541e12b1b5" class="PageRoot"><ul id="https://www.notion.so/598402b92623437d9d84a54f3a552869" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/a15d039fde394f1cac5fbcee4e4c790f"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">容器</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3e3a8161aa2d43118cbdc455e448010e"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HashMap</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8e0d3f5e047a4971a25e9ce84bdaea88"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ConcurrentHashMap</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/48845e7598aa41ba93a7fdeaa5891ada"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">WeekHashMap</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/f8823f4265bd42de87384e3124debf8e"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HashTable</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/cbfe92056407477c97b3a0b44fb558d0"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">运行时数据区域</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/67260607bb274ccd8b9f0b2807e799c8"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">垃圾回收</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/55567a902fc64504b8e04cc4ee3245b8"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">垃圾回收算法</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/31ae9de7440c42ce8374472dbff36584"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">垃圾收集器</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/fdb45b96549f4c7c95dc825a7c92b339"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">并发</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c57c2b8f8741421d858a669174ae1039"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">线程安全的几种方式</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e5e044177b1041c9a6f0b07abca3bb85"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">封装类型</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/549d4334dc9946eda731e86df676a63d"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">中断</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/9364621b46dc4b3693fe48b102a4e2a2"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Metaspace</span></span></div></a></li></ul><h1 id="https://www.notion.so/a15d039fde394f1cac5fbcee4e4c790f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a15d039fde394f1cac5fbcee4e4c790f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">容器</span></span></h1><h2 id="https://www.notion.so/3e3a8161aa2d43118cbdc455e448010e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/3e3a8161aa2d43118cbdc455e448010e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HashMap</strong></span></span></h2><div id="https://www.notion.so/5eda4486a2574699a0f6d65f752cee88" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">存一个 hash 桶，每个桶对应相应 hash 值的链表，从 JDK 1.8 开始，一个链表长度大于等于 8 的时候会将链表转化成红黑树。</span></span></p></div><h2 id="https://www.notion.so/8e0d3f5e047a4971a25e9ce84bdaea88" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8e0d3f5e047a4971a25e9ce84bdaea88"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ConcurrentHashMap</strong></span></span></h2><div id="https://www.notion.so/e7cb573986654a85a17dad2b2edb002f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">JDK 1.7 用的是分段锁，几个锁各自对应几个桶区间。到了 1.8 之后，改成了锁单个桶，如果对应桶为空，就 CAS，其他情况使用 synchronized 桶的头节点。</span></span></p></div><div id="https://www.notion.so/93dd2b4106784c1dad612934839af107" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">resize 操作 1.7 我不是很清楚，1.8 也是 CAS，通过 CAS 一个叫 sizeCtrl 的 field 实现只有一个线程在 resize。</span></span></p></div><div id="https://www.notion.so/f666bdbeb1cc457a9cccfe14047984b7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">https://github.com/CyC2018/CS-Notes/blob/master/notes/Java%20%E5%AE%B9%E5%99%A8.md 上面说 1.7 的 HashMap 和 ConcurrentHashMap 是头插，即把插入元素放到桶的第一个位置，但是自己看1.8的源码都是尾插了。原因是因为扩容的时候是 for 元素拆入，这个时候头插会改变列表的顺序（如果一个几个元素还在一个桶中，它们的顺序会倒过来），如果并发发生，可能会出现链表成环的问题。</span></span></p></div><h2 id="https://www.notion.so/48845e7598aa41ba93a7fdeaa5891ada" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/48845e7598aa41ba93a7fdeaa5891ada"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">WeekHashMap</strong></span></span></h2><div id="https://www.notion.so/f57c574085ab4cdda9639fecd1e57904" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">WeekHashMap 的 Entry 继承自 WeakReference，被 WeakReference 关联的对象在下一次垃圾回收时会被回收，可用作缓存。</span></span></p></div><div id="https://www.notion.so/ac702d09434041d5b7b9779639209142" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">相关 WeakReference 都被一个 ReferenceQueue 串起来，一些特定的操作会触发清空操作，用来清除 queue 中已被清空的 Entry。</span></span></p></div><h2 id="https://www.notion.so/f8823f4265bd42de87384e3124debf8e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/f8823f4265bd42de87384e3124debf8e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">HashTable</strong></span></span></h2><div id="https://www.notion.so/8281577e6248409093de4aedd96c1052" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">方法命名和 HashMap 稍有不同，比如 elements (values()), contains (containsValue)。</span></span></p></div><div id="https://www.notion.so/bd69e2d4065c40a9912310c6a2006f8c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HashTable 不支持 null value。</span></span></p></div><div id="https://www.notion.so/60d20c79d8c94c05b7880ccb1b3a6b3c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">内部 hash 桶相关的数据结构，和 HashMap 相比也是类似的。</span></span></p></div><div id="https://www.notion.so/7fc1b32cce7447acae217aa51e400ce3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">两者扩容的方法是不一样的，HashMap 的大小始终是2的幂次，HashTable 则是尽量使用奇数（素数），初始大小为 11，每次扩充为 2n + 1。</span></span></p></div><div id="https://www.notion.so/50d7efe232f140bc86f3f3baec202315" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HashMap 的优点是计算可直接使用位运算，但是幂次会导致不均匀，所以 HashMap 的 hash 过程中还会加上一个打散操作。</span></span></p></div><div id="https://www.notion.so/c12b82d1e9ff4baba9493da05c64fbab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">HashTable 是线程安全的，因为使用了 synchronized。</span></span></p></div><h1 id="https://www.notion.so/cbfe92056407477c97b3a0b44fb558d0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/cbfe92056407477c97b3a0b44fb558d0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">运行时数据区域</span></span></h1><div id="https://www.notion.so/5fa612c6e5b54f888620a421ed96e794" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F66361159-58a5-49c4-9364-3b7857b9d5b2%2FUntitled.png?width=432&amp;table=block&amp;id=5fa612c6-e5b5-4f88-8620-a421ed96e794"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F66361159-58a5-49c4-9364-3b7857b9d5b2%2FUntitled.png?width=432&amp;table=block&amp;id=5fa612c6-e5b5-4f88-8620-a421ed96e794" style="width:432px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/b83653aae26047bb84166205c98fb9bb" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">程序计数器，记录正在执行的 Java 虚拟机字节码指令的地址。</span></span></li><li id="https://www.notion.so/2abe556260d24f1ab3a424cfdef87d99" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Java 虚拟机栈，每个 Java 方法在执行时会创建一个栈帧用于存储方法的各种局部信息。</span></span></li><li id="https://www.notion.so/43100a01f84141ad9bb54d43fb7ee569" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">本地方法栈，与 Java 虚拟机栈类似，不过是一般用其他语言编写的本地方法服务。</span></span></li><li id="https://www.notion.so/7f2eadad6b014b03a9ac700d8d06b835" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">堆，所有对象都在这里分配内存，是垃圾回收的主要区域，不同垃圾回收器会用不同的划分方法来切割 Heap（如 CMS 和 G1）。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/9c0f70830c8d485cb4393d189cc075d4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">新生代</span></span></li><li id="https://www.notion.so/f19d46920c5b44f2abe01357b90a8ff7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">老年代</span></span></li></ul></li><li id="https://www.notion.so/538f3985ea3642b7821ffe99c4adda43" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">方法区，用于存放已被加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。方法区是一个 JVM 规范，永久代与元空间都是一种实现方式。</span></span></li><li id="https://www.notion.so/83986e6d9a5c488fbb0e50bd39a83578" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">运行时常量池，方法区的一部分，这些常量在方法运行时会被使用。</span></span></li><li id="https://www.notion.so/3b8f9159db0a46bb954120532904b4cf" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">直接内存，NIO 可以使用 Native 函数库直接分配堆外内存，然后通过堆里的 DirectByteBuffer 对象作为这块内存的引用。</span></span></li></ul><h1 id="https://www.notion.so/67260607bb274ccd8b9f0b2807e799c8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/67260607bb274ccd8b9f0b2807e799c8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">垃圾回收</span></span></h1><div id="https://www.notion.so/74d0a756f0c242599ca29fc8a07bdfd2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">JVM使用可达性分析算法来判断一个对象是否可以被回收，以GC Roots为起始点进行搜索，可达的对象都是存活的，不可达的对象可被回收。</span></span></p></div><div id="https://www.notion.so/9521657c83504452ba2d184968c6a720" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/72880de42801406cb18846b27fa63b7a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">GC Roots一般包含以下内容：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/94a7a6a671ea4c5982ae976039036263" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">虚拟机栈中局部变量表中引用的对象。</span></span></li><li id="https://www.notion.so/38303f36781d4da9afd1ef0e6288b42b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">本地方法栈中JNI（Java Native Interface）引用的对象</span></span></li><li id="https://www.notion.so/38e8f6e344624cec8c0c3c487b08af63" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">方法区中类静态属性引用的对象</span></span></li><li id="https://www.notion.so/b8a43c0f0cc9456d957c4798762bffc3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">方法区中的常量引用的对象</span></span></li></ul><h2 id="https://www.notion.so/55567a902fc64504b8e04cc4ee3245b8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/55567a902fc64504b8e04cc4ee3245b8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">垃圾回收算法</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/3eb5c08b28d842b3b14be2ced5f0ddd0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">标记-清除，检查每个对象是否为活动对象，清除非活动对象并回收空间，由于不会改变活动对象在实际内存中的位置，会产生很多内存碎片。可用的内存放在空闲链表上供搜索。</span></span></li><li id="https://www.notion.so/9fb22b5c1a8b462b891593829208729d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">标记-整理，让所有存活的对象都向一端移动，然后直接清理掉端边界以外的内存。不会产生内存碎片，但是速度较慢。</span></span></li><li id="https://www.notion.so/0c0825fbe09c4cefb162cf5801bbbf6c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">复制，将内存划分为大小相等的两块，每次只使用其中一块，当一块内存用完了，就把存活对象搬到另一块上，再把使用过的内存空间做清理。还可以扩展出Eden和Survivor模式，一个Eden，两个Survivor，一个Survivor大小除以其他内存块大小就是最大内存利用率。每次回收时把所有数据迁移到未使用的Survivor上，然后清理其他内存块。</span></span></li><li id="https://www.notion.so/a3f0505a9d3a4003baab3668d5702c47" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">分代收集，把内存分为不同块（新生代和老年代），不同块采用不同的收集算法，并在不同时机运行（策略：Minor GC只回收新生代，Full GC回收老年代）。不同的对象的代际主要根据其存活过了几次垃圾回收来决定。</span></span></li></ul><h2 id="https://www.notion.so/31ae9de7440c42ce8374472dbff36584" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/31ae9de7440c42ce8374472dbff36584"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">垃圾收集器</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/2cbef3a3952c432c8942eba6b10be844" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">CMS (concurrent mark sweep)</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/37aa1c8641b942c9851b08d8fee57755" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">流程：</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/708d4e9df1ea48b1bf2736161876f97e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">初始标记：只标记GC Roots能直接关联到的对象，速度很快，需要停顿。</span></span></li><li id="https://www.notion.so/d54d43b37e9f462eafdc1059ea0a4bcc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">并发标记：进行GC Roots Tracing，此时不需要停顿，用户线程可工作。</span></span></li><li id="https://www.notion.so/d36d20c72496486e93cf73253b3cb943" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">重新标记：修正并发标记错误，需要停顿。</span></span></li><li id="https://www.notion.so/6fff0deff4f040a087c30f5744b9b4e7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">并发清除：不需要停顿。</span></span></li></ul></li><li id="https://www.notion.so/70ebb7a5d90841928d1fdb3b824b969e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">缺点：</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/13cadd38558f441ab5e9df9226582780" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">吞吐量低。</span></span></li><li id="https://www.notion.so/4b414b3737a84683aeee11ed5d9afd66" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">需要预留内存，防止浮动垃圾。</span></span></li><li id="https://www.notion.so/8571b941babe4459bf8edda5da9c5f93" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">标记-清除算法留下的内存碎片较多。</span></span></li></ul></li></ul></li><li id="https://www.notion.so/038a52b8c4ff454d943cb5b0c1cbb13f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">G1，把内存分成了多个大小相等的独立区域，每个小空间可单独进行垃圾回收，这样内存碎片产生的可能变少。每个空间可被计算对应的垃圾回收时间和收获空间，使可预测的停顿时间模型成为可能。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/83b9bc9d01554c7e9336550f1682ce26" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">流程和 CMS 类似：初始标记、并发标记、最终标记、筛选回收。</span></span></li><li id="https://www.notion.so/55e48bc54d3a45bb9f7870494e7c6ec7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">用到了一个remembered set来标记独立区域之间的对象依赖关系。</span></span></li></ul></li></ul><h1 id="https://www.notion.so/fdb45b96549f4c7c95dc825a7c92b339" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/fdb45b96549f4c7c95dc825a7c92b339"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">并发</span></span></h1><h2 id="https://www.notion.so/c57c2b8f8741421d858a669174ae1039" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/c57c2b8f8741421d858a669174ae1039"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">线程安全的几种方式</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/337ef3611d9c46d68a907665b200cbad" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">互斥同步</span></span></li><li id="https://www.notion.so/9b2276433ec24cc79dbeba717ca952d5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">非阻塞同步 - CAS</span></span></li><li id="https://www.notion.so/313f972140d44ddda8b1aeb7e5edc93e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">消灭 / 保护临界区</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/003b3e9a052149d39150446de6359f26" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">不可变</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/ce86474913b14469b43c6801d4ed530e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">final</span></span></li><li id="https://www.notion.so/f41a5da9814e4fcf8c1780190b90a3b4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">String</span></span></li><li id="https://www.notion.so/b5ca073e6df145e9bbd06d669e22e1fd" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">enum</span></span></li><li id="https://www.notion.so/0a92cd21bde0498b80b812de64ac3f22" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">其他被设计成不可变的类型</span></span></li></ul></li><li id="https://www.notion.so/4508eb9146c141f6aac29c311a588c7c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">幂等</span></span></li></ul></li><li id="https://www.notion.so/e1bb99cb469141f78926c27c3a27b253" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">降低同步 -&gt; 不同步</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/14950036d9d94e62a87b3530431bd6e6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ForkJoinPool</span></span></li><li id="https://www.notion.so/13e7dad1283d4c668402ec18558849c7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Stream</span></span></li></ul></li></ul><div id="https://www.notion.so/bbd71d129f344603add5a6258d219617" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/574c3c528bc74223953c1303a34ed0a0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">互斥同步，锁有公平和不公平之分，公平代表多个线程必须按照申请锁的时间顺序来获得锁，不公平则不需要。</span></span></p></div><div id="https://www.notion.so/2dacc5dbc5294c759be013150b550a83" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">下面是Java提供的两种锁机制：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/0a5baebf2d47422a878463e514897cbb" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">synchronized，JVM提供。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/6dd0586d824746a9b057c093e54c9b24" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">锁升级：虽然各个JVM实现各有不同，但基本可认为synchronized的锁升级是不可逆的，所以不要过于依赖synchronized，各种操作都被JVM实现了，可控制性太差。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/228e78b3c1494d4d9a3273ac5963f9bc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">无锁，该对象未被任何线程占有。</span></span></li><li id="https://www.notion.so/62a0d65a8a654e098ff222ee4b7219ca" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">偏向锁，该对象已经偏向某一线程（线程通过CAS声明对锁的占有），该线程使用对象不需要任何加锁操作。</span></span></li><li id="https://www.notion.so/7c42b102d0654d608b597dfc5a4b8690" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">轻量级锁，使用CAS原语的锁，当一个线程获取偏向锁失败后，锁检测到了多次CAS，于是进入轻量级锁，每次线程调用都需要CAS，多次失败后升级到重量级锁。</span></span></li><li id="https://www.notion.so/f1df51eb4b734ba4b651be1d81337bd0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">重量级锁，使用操作系统的锁机制。</span></span></li></ul></li></ul></li><li id="https://www.notion.so/06f16512f2874314bbd7640f2c7b969e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ReentrantLock，JDK提供。</span></span></li></ul><div id="https://www.notion.so/69fc164e682144569e78e426e857b4dd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/e5e044177b1041c9a6f0b07abca3bb85" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/e5e044177b1041c9a6f0b07abca3bb85"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">封装类型</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/400e6a98138e49f8a7daa463291b9c1d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Condition</span></span></li><li id="https://www.notion.so/af83792a903e43ab9426c0e2da75fd65" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">CountDownLatch</span></span></li><li id="https://www.notion.so/bf18da0c3d1f40be9f367e0bb312374d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">CyclicBarrier</span></span></li><li id="https://www.notion.so/f6b7d48c4fd74c889ea46a61e95285b6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Semaphore</span></span></li><li id="https://www.notion.so/043e229f86594c598390f94a77b8ab73" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">BlockingQueue</span></span></li><li id="https://www.notion.so/cbb8bc75fe8345b0b665f13e93e1a1ad" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">etc</span></span></li></ul><div id="https://www.notion.so/7426e41c2e07419ea8048f4483f0ae10" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/549d4334dc9946eda731e86df676a63d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/549d4334dc9946eda731e86df676a63d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">中断</span></span></h2><div id="https://www.notion.so/7183911cca65477a8788e844eba8732b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">和Kotlin的各种中断机制很类似。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/420c3bd621254dc6b0d796ba3a837d18" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">InterruptedException</code></span><span class="SemanticString">，但一个线程被调用了 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interrupt()</code></span><span class="SemanticString"> 方法后，如果线程处于阻塞或等待状态，就会抛出 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">InterruptedException</code></span><span class="SemanticString">，但是 I/O 阻塞和 synchronized 锁阻塞不会被影响。</span></span></li><li id="https://www.notion.so/3b1ecdac5b2e4e69b5e875c5a800ae78" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interrupted()</code></span><span class="SemanticString">，线程可以主动调用其内部的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interrupted()</code></span><span class="SemanticString"> 方法来知道自己是否已经被中断了。</span></span></li><li id="https://www.notion.so/8bc21107be4248ab95d4be0297b7235e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Executor 的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">shutdown()</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">shutdownNow()</code></span><span class="SemanticString"> 方法可以关闭线程，前者是等待已运行的线程执行完毕后再关闭，后者则是调用每个线程的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interrupt()</code></span><span class="SemanticString"> 方法。</span></span></li></ul><h1 id="https://www.notion.so/9364621b46dc4b3693fe48b102a4e2a2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/9364621b46dc4b3693fe48b102a4e2a2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Metaspace</span></span></h1><div id="https://www.notion.so/5a17dc40c6c54e98b2222e37345652d2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">替代了永久代(permanent generation)，其作用是：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/0005c5ebca6d471f886cd8bd3dcf1895" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">存储所有的 static content，包括</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/d5f26a49047b442d89d281b1a187dbe3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">静态方法</span></span></li><li id="https://www.notion.so/4fef22a228d642d08140a4631200c2cf" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">primitive variables</span></span></li><li id="https://www.notion.so/e742946cb79149308fa8c0c834a0a4aa" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">String Pool</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/037a1928bb2140e18074de161a1903c0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">这就会导致 OOM。</span></span></li></ul></li></ul></li><li id="https://www.notion.so/9c029e1e1109490dad5c7e587344ec8e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">存储 classloader</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/f0d7a66e2ec046b1b642cee09b9db1a0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">classloader 用来从 .jar 文件里面导入 .class，每个 class 使用自己的 classloader 可以保证一个 server 对某个 application 代码进行重新部署，而不影响其他 application。</span></span></li><li id="https://www.notion.so/7531bc9c859641329c16411722fe5366" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">这也会导致 OOM。</span></span></li></ul></li></ul><div id="https://www.notion.so/261578f05836447a93810ac8ff7ef527" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/093f7cd304f548e68855839f73c4fcf0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">为什么OOM不会被垃圾回收阻止？貌似是一些实现的问题</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/ea4c18024c934468b7e902fc0803981d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">永久代的 GC 发生在 full gc，频率较低。</span></span></li><li id="https://www.notion.so/ad954b78a05a4d91a326c05cd3597f01" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">classloader和实例会有循环依赖的问题，貌似在JDK 5及以前不能被很好地解决。</span></span></li></ul><div id="https://www.notion.so/992980474ed34fff9d4733528a19d77c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">永久代最大的缺点是其大小是不可以动态调节的。</strong></span></span></p></div></article>
  <footer class="Footer">
</footer>
</body>

</html>