<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-webfont/1.6.0/style.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://raw.githubusercontent.com/yujiachen-y/yjc567.github.io/main/pictures/icon.JPG">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>Golang 语法相关笔记&nbsp;|&nbsp;Jiachen’s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="Golang 语法相关笔记">
  
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://raw.githubusercontent.com/yujiachen-y/yjc567.github.io/main/pictures/icon.JPG"></span>&nbsp;
      
      <span>主页</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="tag/%E6%9D%82%E6%96%87.html">
    <div class="Navbar__Btn">
      <span>杂文</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="tag/%E6%8A%80%E6%9C%AF.html">
    <div class="Navbar__Btn">
      <span>技术</span>
    </div>
  </a>
  <span class="Navbar__Delim">&centerdot;</span>
  <a href="tag/%E9%98%85%E8%AF%BB.html">
    <div class="Navbar__Btn">
      <span>阅读</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="other.html">
        <div class="Navbar__Btn">
          
          <span>其他</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
          <span>关于</span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
    <h1 class="Header__Title">Golang 语法相关笔记</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on 2023年7月22日周六</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/技术.html">技术</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/a6e0efefb7754b758497daade180a075" class="PageRoot"><ul id="https://www.notion.so/bbe04f0bc7ab455185d37749f13a22c2" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/3cb540c090e04242bbac86152b0e4f3a"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Basic Types</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/5b72f78a06c64e97ab4e184d775364ec"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Numbers</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ecc14a9dfd234a3bbbe104ebe4b7bea5"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">intergers</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/f104aedef246459798dfb45502041633"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">floating-point numbers</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7735c933875b417ab917c60c65e26867"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">complex numbers</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/30edb352f595426aa3a436b2ef518045"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Strings</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/448520349f7541c0877001e137a3f163"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Booleans</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7ce73a7f40e2460e86f3784d9e4ac119"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Aggregate Types</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c6248cff79d94cf49ad0008699a1172f"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Arrays</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8dd48aaeaf6f46c2a2f4ef53741f6e83"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Structs</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/efeac14f9b95438aa209d6367df555e4"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Reference Types</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/96dcffe8418b428da66595dc3e82ccf8"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Pointers</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b2093621cf174c2d83f4068bc4f46791"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Slices</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d8a705c1072f4120b45715c6d8d29e09"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Maps</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/99b5fc686d7e4fa080cdc5a1a005b391"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Functions</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8e28fa6a565747ab87ed9d50f3286d46"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Channels</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/79a5b67d00b548478ee35831b6b15c36"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Interfaces</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1ec7b59330324999b21ee727a4a00ce0"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Basic interfaces</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/a5a3377bcde2431d9afebe09d00b712b"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">Embedded interfaces</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/29baab6e89a64e2aa2b3bd05e2ca3270"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">General interfaces</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/be6c4b99a17c4da0b1d75ddbeed13d76"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">类型比较</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/18959c40694f46c9849e8b9d116b60c4"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">Range</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b55e6b31e89348beb2a5c3f332ec6e54"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">创建变量</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/58bf61ae662244c59da97fd641b51054"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">占位符</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/c68a264b7f11428d9f2a9cf1422be39f"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">JSON</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/0b26beb74454432886c3390477d73bf2"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">https://github.com/bytedance/mockey</span><span class="SemanticString"> 中的 mock 是如何实现的</span></span></div></a></li></ul><h1 id="https://www.notion.so/3cb540c090e04242bbac86152b0e4f3a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/3cb540c090e04242bbac86152b0e4f3a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Basic Types</span></span></h1><div id="https://www.notion.so/07df1902b0f84176b40f60e0575b574f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">推荐用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString"> 来创建指针， </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">int</code></span><span class="SemanticString"> 类型还有对应的 untype 类型，作为对应的编译器常量，精度在 256 bits 以上。</span></span></p></div><h2 id="https://www.notion.so/5b72f78a06c64e97ab4e184d775364ec" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/5b72f78a06c64e97ab4e184d775364ec"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Numbers</span></span></h2><div id="https://www.notion.so/30f065bdce8242569be73b41a707f745" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">只有 intergers 有跟随编译器变化位数的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">int</code></span><span class="SemanticString"> 类型，其他都指定了位数，例如只有 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">float64</code></span><span class="SemanticString"> 类型没有 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">float</code></span><span class="SemanticString"> 类型。</span></span></p></div><h3 id="https://www.notion.so/ecc14a9dfd234a3bbbe104ebe4b7bea5" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ecc14a9dfd234a3bbbe104ebe4b7bea5"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">intergers</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/5891250298d142e0890e68885e580c99" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">(signed, unsigned) * (four sizes: 8, 16, 32, 64) = 8 types</span></span></li><li id="https://www.notion.so/479d3793a6a94865b4bbbe26232b6188" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">int, uint, depend on particular platform</span></span></li><li id="https://www.notion.so/1333e44ecff04550a6e97e6f75bbb7ba" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">rune: int32</span></span></li><li id="https://www.notion.so/10fd892544b6461982018df25a9ca9bb" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">byte: uint8</span></span></li><li id="https://www.notion.so/124c269a79e54005b9aa0f58313d1d50" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">uintptr: width is not specified but is sufficient to hold all the bits of a pointer value.</span></span></li></ul><div id="https://www.notion.so/33ecc3636fc54898bf86479a7e01a727" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一般和外界对接要指明符号和大小，但程序内更推荐使用int。</span></span></p></div><h3 id="https://www.notion.so/f104aedef246459798dfb45502041633" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/f104aedef246459798dfb45502041633"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">floating-point numbers</span></span></h3><h3 id="https://www.notion.so/7735c933875b417ab917c60c65e26867" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/7735c933875b417ab917c60c65e26867"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">complex numbers</span></span></h3><h2 id="https://www.notion.so/30edb352f595426aa3a436b2ef518045" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/30edb352f595426aa3a436b2ef518045"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Strings</span></span></h2><div id="https://www.notion.so/24f8d5f5512a42b6ad779f957876435a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">string</code></span><span class="SemanticString"> 都是 immutable 的，所以直接拼接 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">string</code></span><span class="SemanticString"> 很浪费内存，类似 java 中的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">StringBuilder</code></span><span class="SemanticString">，Go 中有 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">bytes.Buffer</code></span><span class="SemanticString"> 来临时存放字符，最后再转化成 string。</span></span></p></div><div id="https://www.notion.so/d66c2e3ceff54f7da4a4126b93315ee8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">所有 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">string</code></span><span class="SemanticString"> 采用 UTF-8 编码，因此 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">string</code></span><span class="SemanticString"> 的 len 不是其字符数量（UTF-8 编码有可能超过一个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">byte</code></span><span class="SemanticString">），可以用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">utf8.RuneCountInString</code></span><span class="SemanticString"> 来获得其中 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">rune</code></span><span class="SemanticString"> 字符的长度。</span></span></p></div><div id="https://www.notion.so/2bcca19589de48c79db420b8da95168b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/2620da846e394cd5b3fe733cc1c0cbb0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">rune</code></span><span class="SemanticString"> 代表一个 UTF-8 字符，格式为：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/ad5b2b685a8341dfa963b449ebd3bc59" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">0xxxxxx runes 0-127 (ASCII)</span></span></li><li id="https://www.notion.so/f69543bf90ca46068798cae270b08826" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">11xxxxx 10xxxxxx 128-2047 (Values &lt; 128 unused)</span></span></li><li id="https://www.notion.so/207b68e803b144b1a202402f2b7b7fdc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">110xxxx 10xxxxxx 10xxxxxx 2048-65535 (Values &lt; 2048 unused)</span></span></li><li id="https://www.notion.so/07c05e8b11c142d2875cbe4996600475" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">1110xxx 10xxxxxx 10xxxxxx 65536-0x10ffff (Other value unused)</span></span></li></ul><div id="https://www.notion.so/255f1235d8574a179fb09f6b143919a2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/c36786dde4284870829aa0fcefbec970" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">UTF-8 有如下特性：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/4784b92123eb4b0f9664f35e05cdc83b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">为了找到一个字符的开头，不会往前回溯超过3个 bytes。</span></span></li><li id="https://www.notion.so/d008de5427d14490ad68c3d8579ffde7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">解码顺序从左到右，不需要 bookahead。</span></span></li><li id="https://www.notion.so/3007513745ae4651bbc07296e2860797" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">没有一个 UTF-8 编码是另一个编码的子串，这让查找很方便。</span></span></li><li id="https://www.notion.so/d09e28e05fa848e0a81dd9d8010acba3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">UTF-8 字符的字典序等同于其编码顺序。</span></span></li><li id="https://www.notion.so/c902256193854e709f6bba712a91d662" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">一个我不知道的知识点：没有 NUL（zero）bytes，方便编程语言设置其 NUL 符号。</span></span></li></ul><h2 id="https://www.notion.so/448520349f7541c0877001e137a3f163" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/448520349f7541c0877001e137a3f163"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Booleans</span></span></h2><h1 id="https://www.notion.so/7ce73a7f40e2460e86f3784d9e4ac119" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/7ce73a7f40e2460e86f3784d9e4ac119"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Aggregate Types</span></span></h1><h2 id="https://www.notion.so/c6248cff79d94cf49ad0008699a1172f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/c6248cff79d94cf49ad0008699a1172f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Arrays</span></span></h2><div id="https://www.notion.so/b433197fc21a4b3ab6a4b579944153a2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">array</code></span><span class="SemanticString"> 可以在初始化的时候指定每一位的元素值，如下面例子</span></span></p></div><pre id="https://www.notion.so/6dc809d2855045668d5f3ea9552c3676" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>type Currency int

const (
		USE Currency = iota
		EUR
		GBP
		RMB
)

symbol := […]string{USD: “$”, EUR: “€”, GBP:”£”, RMB: “¥”}

fmt.Println(RMB, symbol[RMB]) // “3 ¥”</span></span></span></code></pre><h2 id="https://www.notion.so/8dd48aaeaf6f46c2a2f4ef53741f6e83" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8dd48aaeaf6f46c2a2f4ef53741f6e83"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Structs</span></span></h2><h1 id="https://www.notion.so/efeac14f9b95438aa209d6367df555e4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/efeac14f9b95438aa209d6367df555e4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Reference Types</span></span></h1><h2 id="https://www.notion.so/96dcffe8418b428da66595dc3e82ccf8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/96dcffe8418b428da66595dc3e82ccf8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Pointers</span></span></h2><div id="https://www.notion.so/5fe76a7adb9c48af8b1b197a2644d49a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">For </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">a</code></span><span class="SemanticString"> of pointer to array type: </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">a[x]</code></span><span class="SemanticString"> is shorthand for </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">(*a)[x]</code></span></span></p></div><div id="https://www.notion.so/977ce4ed410042fa97695dc1def99dd2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">If </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">a</code></span><span class="SemanticString"> is a pointer to an array, </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">a[low : high]</code></span><span class="SemanticString"> is shorthand for </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">(*a)[low : high]</code></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/0b1004eaf183495aaeddda021934f4a4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">If </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x</code></span><span class="SemanticString"> is addressable and </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&amp;x</code></span><span class="SemanticString">&#x27;s method set contains </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">m</code></span><span class="SemanticString">, </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">x.m()</code></span><span class="SemanticString"> is shorthand for </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">(&amp;x).m()</code></span></span></p></div><div id="https://www.notion.so/e55b0a76d8f741b69aa6cc11bbfe7cf6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">statement </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">*p++</code></span><span class="SemanticString"> is the same as </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">(*p)++</code></span><span class="SemanticString">.</span></span></p></div><h2 id="https://www.notion.so/b2093621cf174c2d83f4068bc4f46791" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/b2093621cf174c2d83f4068bc4f46791"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Slices</span></span></h2><div id="https://www.notion.so/75d8af27ce4842c780f936a5316fb5b3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 之间不能用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">==</code></span><span class="SemanticString"> 比较符号。</span></span></p></div><div id="https://www.notion.so/c86264a5b20843f099940f5cf3f83119" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">唯一被允许的比较是 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice == nil</code></span><span class="SemanticString">，为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 内置 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">==</code></span><span class="SemanticString"> 比较符号会有一些deep comparison的问题：</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/d1a30502e90846388467e955dc8b131a" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">array</code></span><span class="SemanticString"> 不一样， </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 的底层数据结构是 indirect 的，甚至可能出现一个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 中的元素引用这个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 的情况。</span></span></li><li id="https://www.notion.so/382333669d5a41159582a19b60c86e28" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 的底层 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">array</code></span><span class="SemanticString"> 是有可能被改变的，移除内置 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">==</code></span><span class="SemanticString"> 让 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 无法作为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">map</code></span><span class="SemanticString"> 的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">key</code></span><span class="SemanticString">。</span></span></li></ol><h2 id="https://www.notion.so/d8a705c1072f4120b45715c6d8d29e09" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d8a705c1072f4120b45715c6d8d29e09"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Maps</span></span></h2><div id="https://www.notion.so/693717d430af4835b051846f4e9347fa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Spec</strong></span></span></p></div><div id="https://www.notion.so/7148efebe5d842c4b5f64cb7ea0c7be6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">map</code></span><span class="SemanticString"> 中的 value 无法被取地址，这是为了防止 rehash 导致地址变化带来问题。因此你无法对 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">map</code></span><span class="SemanticString"> 中的 value 唤起 pointer method，因为没有地址可传入。</span></span></p></div><div id="https://www.notion.so/8743b0cb300a4dd28537143ad9ce487b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">map</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span><span class="SemanticString"> 一样，没有内置的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">==</code></span><span class="SemanticString"> 操作</span></span></p></div><div id="https://www.notion.so/c93b80e084c2427e850430e101ab92c2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/58573e83ae4e4c288866855603e68224" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">数据结构</strong></span></span></p></div><div id="https://www.notion.so/a09dd4fd61be419b8030e6d6d51dcd17" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">type hmap struct { ... }</code></span><span class="SemanticString"> ，其中 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">B uint8</code></span><span class="SemanticString"> 代表当前哈希表持有的 buckets 数量的 2 次幂，即 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">len(buckets)</code></span><span class="SemanticString"> = </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="2^B"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>B</mi></msup></mrow><annotation encoding="application/x-tex">2^B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="SemanticString">。</span></span></p></div><div id="https://www.notion.so/89bf8bc1759c473082f247d6d2a076c9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">每个 bucket 对应的是 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">runtime.bmap</code></span><span class="SemanticString">，一个 bucket 会存 8 个键值对，一旦桶溢出，多余的键值对则会转移到溢出桶。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/8597b6b03c1f45d4861062e8befdcfb7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">当桶的数量少于 24 时，由于数据较少、使用溢出桶的可能性较小，因此会省略创建过程以减少额外开销。</span></span></li><li id="https://www.notion.so/efa414a73251474fa1ab3b78e5bc230a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">当桶的数量多于 24 时，会额外创建 </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="2 ^ {B - 4}"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>B</mi><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2 ^ {B - 4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="SemanticString"> 个溢出桶。</span></span></li></ul><div id="https://www.notion.so/704d695b97d64e8dbbf8d399c14804d4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/a34a92b2964f4bbe870dcdbbae048af6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">寻址</strong></span></span></p></div><div id="https://www.notion.so/1dfcadcaf11a4ff299693a68adb68b82" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">用 key hash 的后面几位决定目标桶，用 key hash 的前 8 位比较 key 是否相等。</span></span></p></div><div id="https://www.notion.so/a6d59eebde944cc1a090774b96d0dc21" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">for loop 时 runtime 会 random 出一个起点，如果中途修改 map 中的 kv，被修改的 kv 能否被遍历到取决于修改时 iterator 的位置是否在被修改 kv 的前面。</span></span></p></div><div id="https://www.notion.so/95b3906297ef4dd79b6097b773102534" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/eaef2ed167694ca0a8cb9ce349c749e4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">扩容</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/4b6619c193094109be87f3901ea9c89a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">装载因子超过 6.5（元素数量 / 桶数量）-&gt; 翻倍扩容，将桶的数量翻倍。</span></span></li><li id="https://www.notion.so/ab93cfeda2b246b0919c6878f9a4e3ec" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">溢出数量桶超过某个阈值（未知，GPT 说因运行平台和版本而异）-&gt; 等量扩容，桶的数量和原先相同，例如一个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">map</code></span><span class="SemanticString"> 被插入了太多数据又被删除，就会导致溢出桶过多而装载因子较小。</span></span></li></ul><div id="https://www.notion.so/656677eb0d23407d85a73f63190d7129" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">扩容不会修改 hash 因子，在扩容期间向旧桶写入、删除数据时会引发旧桶数据向新桶分流。</span></span></p></div><h2 id="https://www.notion.so/99b5fc686d7e4fa080cdc5a1a005b391" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/99b5fc686d7e4fa080cdc5a1a005b391"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Functions</span></span></h2><div id="https://www.notion.so/0f1fcc18753f438ba1a7ed2440053343" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">注意 receiver 定义为指针类型的情况，调用时就自动转化 value 为指针的默认行为是为了方便指针方法修改 receiver 内部状态，如果 receiver 是 value 其内部状态就不会被修改。这一点和 C 的 const 有点类似。</span></span></p></div><h2 id="https://www.notion.so/8e28fa6a565747ab87ed9d50f3286d46" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/8e28fa6a565747ab87ed9d50f3286d46"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Channels</span></span></h2><div id="https://www.notion.so/cf87b72edd5346b48346c3e8e2f4e39c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">从已经关闭的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">channel</code></span><span class="SemanticString"> 接收消息会立即得到零值，可以用 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">_, ok := &lt;-ch</code></span><span class="SemanticString"> 的方法判断 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">channel</code></span><span class="SemanticString"> 是否已经关闭。</span></span></p></div><div id="https://www.notion.so/9ecbcb09c8af4df9bbd7ee90a049e408" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">close 已关闭的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">channel</code></span><span class="SemanticString"> 或者 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">nil</code></span><span class="SemanticString"> </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">channel</code></span><span class="SemanticString"> 会导致 panic。</span></span></p></div><div id="https://www.notion.so/3023031426a0467bb5d0df25cb2d213e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">从 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">nil</code></span><span class="SemanticString"> </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">channel</code></span><span class="SemanticString"> 接收消息会 block forever。</span></span></p></div><div id="https://www.notion.so/68b20ddd03374d80986a677f30619b69" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">channel</code></span><span class="SemanticString"> 的计算效率目前和直接使用锁相比并不高。</span></span></p></div><h1 id="https://www.notion.so/79a5b67d00b548478ee35831b6b15c36" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/79a5b67d00b548478ee35831b6b15c36"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Interfaces</span></span></h1><div id="https://www.notion.so/a0e903853e7346ecb109ac62fdca1465" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">一个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 里包含了两个值，代表其指向元素的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">type</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">value</code></span><span class="SemanticString"> ，因此 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">val i interface{} := new(SomeType)</code></span><span class="SemanticString"> 中的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">i</code></span><span class="SemanticString"> 并不等于 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">nil</code></span><span class="SemanticString"> ，因为它还包含了一个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">type</code></span><span class="SemanticString"> 值。</span></span></p></div><h2 id="https://www.notion.so/1ec7b59330324999b21ee727a4a00ce0" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/1ec7b59330324999b21ee727a4a00ce0"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Basic interfaces</span></span></h2><h2 id="https://www.notion.so/a5a3377bcde2431d9afebe09d00b712b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/a5a3377bcde2431d9afebe09d00b712b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Embedded interfaces</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/feb387819138448884b54bdadabbe027" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">一个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 里可以加上其他 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 的名字，代表其拥有这些子 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 的所有方法（这个就是接口的组合吧）。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/f279b2ae57ea442a96a7d090c8cd8595" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">区分点：此时这个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 的method set变大了（有了其子 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface </code></span><span class="SemanticString">的所有method），但是其 type set 变小了（子 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 对应type sets的交集）。</span></span></li><li id="https://www.notion.so/3262fac4a7b14ceab41daf4acd6966d0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">应该不允许出现同名但参数类型不同的方法</span></span></li></ul></li></ul><h2 id="https://www.notion.so/29baab6e89a64e2aa2b3bd05e2ca3270" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/29baab6e89a64e2aa2b3bd05e2ca3270"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">General interfaces</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/6c737e126f734dd5a36f397c3dc99464" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">~type</code></span><span class="SemanticString">，代表这个 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interfece</code></span><span class="SemanticString"> 的 underlying type 是某 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">type</code></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/55e3eaf0cb474f6899b9a3790c53cf39" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">~T</code></span><span class="SemanticString"> 中的 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">T</code></span><span class="SemanticString"> 必须是 underlying type 自身，且 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">T</code></span><span class="SemanticString"> 不可以是 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span></span></li></ul></li><li id="https://www.notion.so/afd9698df84343779fa7b8d09a43f92a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">t1|t2|…|tn</code></span><span class="SemanticString"> 代表这些 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 所有 </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">type set 的并集</strong></span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/0cc5c2e0a5644eb880c0c2067c0b4093" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">其中不能混有类型参数，且非 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">interface</code></span><span class="SemanticString"> 的类型不能有相同的类型，即不可以写 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">t1|t1</code></span></span></li></ul></li></ul><h1 id="https://www.notion.so/be6c4b99a17c4da0b1d75ddbeed13d76" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/be6c4b99a17c4da0b1d75ddbeed13d76"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">类型比较</span></span></h1><ol class="NumberedListWrapper"><li id="https://www.notion.so/78a50d423b8c4c908d1d500e68add952" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">A named type is always different from any other type;</span></span></li><li id="https://www.notion.so/7504c90a165649abaaf5f1790b0e1151" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">Otherwise, two types are identical if their underlying type literals are structurally equivalent.</span></span></li></ol><div id="https://www.notion.so/f527b737e4654770b2864c6b712801c4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">whether two values may be compared with == and != is related to assign ability to: in any comparison, the first operand must be assignable to the type of the second operand or vice versa.</span></span></p></div><div id="https://www.notion.so/0952ea7c519d40a8b67c821fa4503b12" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Arithmetic operators apply to numeric values and yield a result of the same type as the first operand.</span></span></p></div><h1 id="https://www.notion.so/18959c40694f46c9849e8b9d116b60c4" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/18959c40694f46c9849e8b9d116b60c4"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Range</span></span></h1><div id="https://www.notion.so/2e9306f3e8b4463c91ee23044ae1c9d2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">range</code></span><span class="SemanticString"> 右边的表达式叫做 range expression</span></span></p></div><div id="https://www.notion.so/70eaa1fb39fd4c889cb853b9e1a7c398" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">range expression 的 core type 只能是：</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/9ba06413e4894c54a8ad413de630461c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">(pointer to an) </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">array</code></span></span></li><li id="https://www.notion.so/caac6b7395bd46aba78b04caddefc36d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">slice</code></span></span></li><li id="https://www.notion.so/b2d3bfdcd1b143b7b70c743587424d0f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">string</code></span></span></li><li id="https://www.notion.so/81cb6167c8e34f4aba149d74acf2edda" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">map</code></span></span></li><li id="https://www.notion.so/34584a1955b446ab9a1f21fe91990227" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">channel</code></span><span class="SemanticString"> permitting receive operations</span></span></li></ul><div id="https://www.notion.so/848db49b345d46efa878f1c412752cc5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/da8de44a11174793af7f4e70d6774a1e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">range</code></span><span class="SemanticString"> 关键词本质上是一个语法糖，其在编译后会被展开为一个 for，针对不同结构体，展开结果不同，大致形式为：</span></span></p></div><pre id="https://www.notion.so/8669ca0c5c794dc7933045c213999bff" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>ha := a
hv1 := 0
hn := len(ha)
v1 := hv1
v2 := nil
for ; hv1 &lt; hn; hv1++ {
		tmp := ha[hv1]
		v1, v2 = hv1, tmp
		...
}</span></span></span></code></pre><details id="https://www.notion.so/522114edaf624d8d9b3b39c5015d4317" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle "><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Core type</span></span></summary><div class="Toggle__Content"><div id="https://www.notion.so/d2b67657e8a1407b80f4b7a9a5ba4d94" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">non-interface 的 core type 和其 </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.notion.so/50599799d3bc42f89fdade4563f40dc9?pvs=25#3559116643be4e53b0d9a9cdd497b2f1">underlying type</a></span><span class="SemanticString"> 一样</span></span></p></div><div id="https://www.notion.so/f69ccc12c3f54ad5b368341ac196f135" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">interface在这两种情况下有core type</span></span></p></div><ol class="NumberedListWrapper"><li id="https://www.notion.so/366c28a4c3354b6dbd30f01af6921a7b" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">其 type set 中的所有 type 有相同的一个 underlying type </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">U</code></span><span class="SemanticString">，那么其 core type 为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">U</code></span><span class="SemanticString">。</span></span></li><li id="https://www.notion.so/e282c681860b40218536eb8e030177b2" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">type set 只有 channel type，方向相同，返回的都是 type E，那么其 core type 为 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">E</code></span><span class="SemanticString">。</span></span></li></ol></div></details><h1 id="https://www.notion.so/b55e6b31e89348beb2a5c3f332ec6e54" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/b55e6b31e89348beb2a5c3f332ec6e54"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">创建变量</span></span></h1><ul class="BulletedListWrapper"><li id="https://www.notion.so/3bd3e11add1c46ef9db3efbace79ddb0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString">：创建一个zero value的 basic type，返回对应的指针，其他方法就比 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">new</code></span><span class="SemanticString"> 要啰嗦（new就一行。</span></span></li><li id="https://www.notion.so/8fed02542f8f4623a12930d397d6c915" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">composite literals。</span></span></li><li id="https://www.notion.so/7dfe1e6733df48fb8f377cfe27032da7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">make</code></span><span class="SemanticString">：初始化 runtime 内置的 composite literals。</span></span></li></ul><div id="https://www.notion.so/445bdc33d8924f36a705b296a5fa6950" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">没有被给定指定值的变量都会被赋予zero value。</span></span></p></div><div id="https://www.notion.so/66ebd1be6ce24364a3907ff0dd4c1e4f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">定义变量只是定义变量之间的DAG，真正的初始化从第一个没有依赖其他变量的变量开始。</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://go.dev/ref/spec#Package_initialization">https://go.dev/ref/spec#Package_initialization</a></span></span></p></div><h1 id="https://www.notion.so/58bf61ae662244c59da97fd641b51054" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/58bf61ae662244c59da97fd641b51054"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://go.dev/src/fmt/doc.go">占位符</a></span></span></h1><div id="https://www.notion.so/b678b0daa0004c8bba9475bb0a706fc7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%d</code></span><span class="SemanticString"> 十进制整数</span></span></p></div><div id="https://www.notion.so/ad225fc2e3c04a11a3b7be825ffb14d8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%x</code></span><span class="SemanticString"> </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%o</code></span><span class="SemanticString"> </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%b</code></span><span class="SemanticString"> 十六进制、八进制、二进制整数</span></span></p></div><div id="https://www.notion.so/5a022542257c4856abcbb3c7ad93d512" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%f</code></span><span class="SemanticString"> </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%g</code></span><span class="SemanticString"> </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%e</code></span><span class="SemanticString"> 浮点数，e 表示 3.1415923e+00 的形式，g 指根据情况选择 f 或 e 输出（看哪个输出格式更紧凑）。All three verbs allow field width and numeric precision to be controlled.</span></span></p></div><div id="https://www.notion.so/96ac2541957348198afc0b1ffbe3305a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%t</code></span><span class="SemanticString"> 布尔值</span></span></p></div><div id="https://www.notion.so/69469e3a5ccd4f5b84b68eb0ca4e3ba3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%c</code></span><span class="SemanticString"> rune、unicode code point</span></span></p></div><div id="https://www.notion.so/91912e6298f14db08868b91562abb39b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%s</code></span><span class="SemanticString"> 字符串、凡是实现了Stringer interface的类型都适用</span></span></p></div><div id="https://www.notion.so/341efb9428184ef3906f5222d2e05f42" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%q</code></span><span class="SemanticString"> quoted string “abc” or rune ‘c&#x27;</span></span></p></div><div id="https://www.notion.so/e691bfc664dc430a8602604efdcef61d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%v</code></span><span class="SemanticString"> any value in a natural format</span></span></p></div><div id="https://www.notion.so/99c6dbc5fc634287a283761063f02f7e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%T</code></span><span class="SemanticString"> type of any value</span></span></p></div><div id="https://www.notion.so/805ddd9aa9534da4984d10bc3d3e6f0f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%%</code></span><span class="SemanticString"> literal percent sign (no operand)</span></span></p></div><div id="https://www.notion.so/490e0efd3b3f474687b9221d37911667" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%w</code></span><span class="SemanticString"> error values</span></span></p></div><div id="https://www.notion.so/c6f99c1266a7450a92278c53f9fcf6c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%[1]d</code></span><span class="SemanticString"> 代表把 format 的第一个参数用十进制整数的形式打印出来，这样多个占位符可以用上相同的参数。举个例子：</span></span></p></div><pre id="https://www.notion.so/42dab542ae554ce8ae46376fea9795cb" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>	fmt.Sprintf(&quot;%[2]d %[1]d\n&quot;, 11, 22) // &quot;22 11&quot;</span></span></span></code></pre><div id="https://www.notion.so/c425357e3ce847a19286bea701c378e4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%#d</code></span><span class="SemanticString"> 代表把前面表示进制（0、0x）的前缀给打印出来</span></span></p></div><div id="https://www.notion.so/b6172e7c84cd4c5ba479b573a81f171e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">% x</code></span><span class="SemanticString">，中间有个空格，代表把数字中的每个元素按照 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">%x</code></span><span class="SemanticString"> 的格式打印出来，每个元素之间用空格分隔。</span></span></p></div><h1 id="https://www.notion.so/c68a264b7f11428d9f2a9cf1422be39f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/c68a264b7f11428d9f2a9cf1422be39f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">JSON</span></span></h1><div id="https://www.notion.so/eefdc702a19b4933b78db4cc3573e3c3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">JSON marshal是依赖反射读取field tag以实现序列化</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/5e73ecb9fd15457ca4fec9fbd569ae76" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">json:&quot;name&quot;</code></span><span class="SemanticString">，表示一个field序列化后的key为name</span></span></li><li id="https://www.notion.so/546a66465e0a46d7b358130d042c9493" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">json:&quot;-&quot;</code></span><span class="SemanticString">，表示序列化忽略这个field</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/fccd507933d24acf94276ed89b0e77c6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">json:&quot;-,&quot;</code></span><span class="SemanticString">，表示这个field序列化后的key为&quot;-&quot;</span></span></li></ul></li><li id="https://www.notion.so/a9036ad027eb4f109d75f51416df749f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">json:&quot;,omitempty&quot;</code></span><span class="SemanticString">，表示在序列化时，如果这个field是空值，忽略这个field</span></span></li><li id="https://www.notion.so/d291c1f4473640cabdad7ddffee62158" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">JSON cannot represent cyclic data structures and Marshal does not handle them.</span></span></li><li id="https://www.notion.so/53dcdd98fd324e78ae79fe9c191996fe" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果想自定义编解码过程，就需要实现 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">encoding/json.Marshaler</code></span><span class="SemanticString"> 和 </span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">encoding/json.Unmarshaler</code></span><span class="SemanticString"> 接口。</span></span></li></ul><h1 id="https://www.notion.so/0b26beb74454432886c3390477d73bf2" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/0b26beb74454432886c3390477d73bf2"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/bytedance/mockey">https://github.com/bytedance/mockey</a></span><span class="SemanticString"> 中的 mock 是如何实现的</span></span></h1><div id="https://www.notion.so/b8d9fe9fb7bc47b791ef5fa800b74aa4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">通过替换函数对应地址的字节码，将函数调用引导进 mock 函数。</span></span></p></div></article>
  <footer class="Footer">
</footer>
</body>

</html>